\section{The Latent Class Analysis Model}

\subsection{The LCA Model}
In this section we will first introduce the classic LCA model and extend this model to include covariate effects using a multinomial logistic regression parametrization. Suppose there are M polytomous manifest variables or items, $u_{1},...,u_{M}$ observed on $N$ individuals in a data sample. Let $\bm{u_{i}} = (u_{1i},...,u_{Mi})^{\intercal}$ denote the full response pattern of individual $i$ where $u_{mi}$ is the response to item $m$. The classic LCA model represented in first diagram of Figure 1 (Lazarsfled \& Henry, 1968; McCutcheon, 1987) assumes that an underlying latent variable $C$ exist, consisting of $K$ latent classes, such that $C_{i}=k; k=1,2,...,K$ if individual $i$ belongs to class $k$. Path diagrams depicted in this thesis follows the convention used in Mplus version 8 User Guide (Muth\'en \& Muth\'en, 1998-2017). Thus, the distribution of a full response pattern can be expressed as 

\begin{align}
P(\bm{U_{i}}) &= \sum_{k=1}^{K} \bigg[ P(C_{i}=k) \cdot P(u_{1i},u_{2i},..,u_{M}|C_{i}=k)\bigg] \\
&=\sum_{k=1}^{K} \bigg[ \pi_{k} \cdot P(u_{1i},u_{2i},..,u_{M}|C_{i}=k)\bigg]
\end{align}
The last term of equation 2.2 can be simplified by $conditional$ $independence$ which is assumed on the M items conditional on latent class membership. This assumption implies that all the associations shared among the observed items is strictly caused by the latent variable or another way of putting it, conditional on the latent variable, responses to all of the manifest variables are assumed to be statistically independent. Conditional independence is depicted in the first diagram of Figure 1. As shown, the items are only connected by the latent variable as indicated by the one-way directional path which signifies that the K items are only related through the latent variable. Thus, we have the following 
\begin{align}
P(\bm{U_{i}}) = \sum_{k=1}^{K} \bigg[ \pi_{k} \cdot  \prod_{m=1}^{M}\prod_{r=1}^{R_{m}} P(u_{mi}=r|c_{i}=k)^{\mathbbm{1}(u_{mi} = r)} \bigg ]
\end{align}
where $\mathbbm{1}(u_{mi} = r)=1$ if $u_{mi}=r$ and $0$ otherwise. The classic LCA model is defined by two sets of parameters: the item response and class proportion probabilities. The item response probabilities are the $measurement$ $parameters$ and describes the relationship between the latent variable and items observed (i.e. it indicates how likely an individual will endorse an item within each latent class and so these results are the basis for the overall interpretation of the latent classes). The vector of item response probabilities sum to 1 conditional on latent class since an individual provides one and only one response to each item within each class. The class proportion probabilities are regarded as the $structural$ $parameters$ as it characterizes the overall distribution of the latent variable, which in the class LCA model specify the relative size of each latent class. Similarly, latent classes are mutually exclusive and exhaustive implying that individuals can only belong to one and only one latent class, hence, the class probabilities sum to 1. 

There are three common characterizations that result in equivalent LCA models: the probability parameterization, the log-linear parameterization and the multinational logistic regression parameterization. The distribution of latent variable is modelled by a standard multinomial logistic regression. The equation is
\begin{align}
    \pi_{k} = P(C=k) = \frac{exp(\beta_{k})}{1 + \sum_{h=1}^{K-1}exp(\beta_{h})}
\end{align} where the reference category is latent class K such that $\beta_{K}=0$. The choice of the reference category is arbitrary and will not affect the results, however, it can impact the ease of interpretation. For a more in depth treatment of multinomial logistic regression please refer to Hosmers and Lemeshow (Year). The item-response probabilities utilize an ordinal logistic regression. It may seem odd to parametrize the item-response probabilites in such a fashion, however, it corresponds to the nature of LCA applications. In several substantive fields, it can be seen that a clear ranking among the categories exist for responses. For example attitudinal questions on social and public opinion surveys follow a Likert-type scale that range from "strongly disagree" to "strongly agree" or from "least important" to "most important." Responses to other survey questions such as "never," "sometimes", "often", or "always" are also examples of ordered categories. Additionally, this is also the chosen parameterization implemented in Mplus Software (Muth\'en \& Muth\'en, 2018). The ordinal logistic regression is based on a latent response formulation and follows the discussion of Skrondal \& Hesketh, 2004. The item $u_{i}$ is an ordinal variable with $R$ response categories and can be viewed as a coarsening of a $continuous$ $latent$ $response$ $variable$ $u^{*}$. Assumed it is modelled by 
\begin{align}
    u_{i}^{*} = \bm{x_{i}}^\intercal \bm{\beta} + \epsilon_{i}
\end{align} where $\bm{x_{i}}$ is a vector of explanatory variables and $\bm{\beta}$ contain the corresponding regression parameters. Now, if $u_{i}$ was a continuous variable then $u_{i} = u_{i}^{*}$ however, for the ordinal variable case, the relationship between $u_{i}$ and $u_{i}^{*}$ is as follows:
\begin{align}
    u_{i} =
    \begin{cases}
    \hspace{1em}1 & \text{if } $u_{i}^{*} \le \tau_{1}$ \\
    \hspace{1em}2 & \text{if } $\tau_{1} < u_{i}^{*} \le \tau_{2}$ \\
    &\hspace{0.2em}\vdots \\
    R-1 & \text{if } $\tau_{R-2} < u_{i}^{*} \le \tau_{R-1}$ \\
    \hspace{1em}R & \text{if } $\tau_{R-1} < u_{i}^{*}$
    \end{cases}
\end{align} The set $({\tau_{1},\tau_{2},..,\tau_{R-1})$ are thresholds or cut-off points. These unknown parameters separate the adjacent response categories. For example, the severity of pain may be labelled as "none", "moderate" or "severe". Individuals are categorized based on where they fall on the assumed underlying continuous latent variable, pain severity. 

%%Place tikz picture here 



The interpretation of the regression parameters utilizes the concept of odds and odd ratios. Generally given two events, Event A and Event B, the odds is defined as the relative chances of any two events: 

\begin{align}
    odds = \frac{P(Event A)}{P(Event B)}
\end{align} When interpreting the odds with a covariate, we can examine the odd ratio: 

\begin{align}
    $odds$ $ratio$ = \frac{ \frac{P(Event A|X=x_{1})}{P(Event B|X=x_{1})}}{ \frac{P(Event A|X=x_{2})}{P(Event B|X=x_{2})}}
\end{align}

The reason behind this selection is due to nature of applications in LCA. In several substantive fields, it can be seen that a clear ranking among the categories exist for responses. For example attitudinal questions on social and public opinion surveys follow a Likert-type scale that range from "strongly disagree" to "strongly agree" or from "least important" to "most important." Responses to other survey questions such as "never," "sometimes," often" and "always" are also examples of ordered categories. Additionally, this is also the chosen parameterization implemented in Mplus Software (Muth\'en \& Muth\'en, 2018). 



In this simulation study, class enumeration is examined under various modelling conditions. Population parameters used for data generation were chosen to reflect work commonly seen in LCA research. For a meaningful and high quality LCA, we require “good” items that accurately measures the underlying latent variable and a strong association exist. A good item is one with both qualities: class homogeneity and class separation (Collins \& Lanza, 2010). If a class has high homogeneity with respect to a particular item, then there is a particular response group on that item item which epitomizes or uniquely distinguishes that class.In the case of binary items, strong associations with a class or high-class homogeneity is indicated by high or low-estimated probabilities – that is item response probabilities $\> 0.7$ or $\< 0.3$ (Masyn, 2013). For example, if an item response probability is 0.95, it implies that 95\% of individuals endorse that particular item and 5\% will not but only within that latent class. We would say that this item may be a typical characteristic of this class. Aside from class homogeneity, we also wish that classes are distinguishable between each other - this quality is called class separation. Similarly, the class proportions or relative sizes of each class may also provide additional information that may be beneficial to the interpretation phase of the analysis. For example, if the class proportion is higher for a specific class relative to others then that class represents majority of the population sample. Population parameters selected for this study will be discussed in Chapter 4.

\subsection{Extending LCA models with Covariates}

As aforementioned, the classic LCA model has been extended allowing researchers to analyze more complicated substantive applications. A common practice in LCA modelling is the inclusion of covariates. Latent class regression (LCR) model is the most popular specification, in which the latent variable, again measured by the observed items, is simultaneously regressed on the covariates with a multinomial logistic regression parametrization.  
